/*! For license information please see 0.js.LICENSE.txt */
"use strict";(self.webpackChunkwhatsmail_pro_version=self.webpackChunkwhatsmail_pro_version||[]).push([[0],{253:(e,t,a)=>{a.d(t,{A:()=>i});var r=a(314),n=a.n(r)()((function(e){return e[1]}));n.push([e.id,'.lds-roller,.lds-roller div,.lds-roller div:after{box-sizing:border-box}.lds-roller{display:inline-block;height:80px;position:relative;width:80px}.lds-roller div{animation:lds-roller 1.2s cubic-bezier(.5,0,.5,1) infinite;transform-origin:40px 40px}.lds-roller div:after{background:currentColor;border-radius:50%;color:#005d4c;content:" ";display:block;height:7.2px;margin:-3.6px 0 0 -3.6px;position:absolute;width:7.2px}.lds-roller div:first-child{animation-delay:-36ms}.lds-roller div:first-child:after{left:62.62742px;top:62.62742px}.lds-roller div:nth-child(2){animation-delay:-72ms}.lds-roller div:nth-child(2):after{left:56px;top:67.71281px}.lds-roller div:nth-child(3){animation-delay:-.108s}.lds-roller div:nth-child(3):after{left:48.28221px;top:70.90963px}.lds-roller div:nth-child(4){animation-delay:-.144s}.lds-roller div:nth-child(4):after{left:40px;top:72px}.lds-roller div:nth-child(5){animation-delay:-.18s}.lds-roller div:nth-child(5):after{left:31.71779px;top:70.90963px}.lds-roller div:nth-child(6){animation-delay:-.216s}.lds-roller div:nth-child(6):after{left:24px;top:67.71281px}.lds-roller div:nth-child(7){animation-delay:-.252s}.lds-roller div:nth-child(7):after{left:17.37258px;top:62.62742px}.lds-roller div:nth-child(8){animation-delay:-.288s}.lds-roller div:nth-child(8):after{left:12.28719px;top:56px}@keyframes lds-roller{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}',""]);const i=n},781:(e,t,a)=>{a.d(t,{A:()=>r});const r="/images/audio.png?46d84dece79a860e9e9680ee40dc2a53"},537:(e,t,a)=>{a.d(t,{A:()=>r});const r="/images/documents.png?449ba13cda9d456205f9f027f1fe4356"},964:(e,t,a)=>{a.d(t,{A:()=>r});const r="/images/image.png?5a26f50495a314ffa59fbb93402cc804"},57:(e,t,a)=>{a.d(t,{A:()=>r});const r="/images/map.png?82056140ce3605dfbf34029e764aae71"},762:(e,t,a)=>{a.d(t,{A:()=>r});const r="/images/video.png?825fa04ed0470feedc474ee57eb57f6a"},0:(e,t,a)=>{a.r(t),a.d(t,{default:()=>xt});var r=a(726),n={class:"chat chat-messages show",id:"middle"},i={class:"chat-header"},s={class:"user-details"},o={class:"avatar avatar-lg online flex-shrink-0"},l=["src"],c={class:"ms-2 overflow-hidden"},d={class:"chat-options"},u={class:"dropdown-menu dropdown-menu-end p-3"},f={class:"chat-search search-wrap contact-search"},p={class:"input-group"},m={class:"chat-body chat-page-group slimscroll"},h={key:0,class:"d-flex justify-content-center"},v={class:"messages chat-area",style:{overflow:"scroll",height:"80vh"}},g={class:"chat-content"},y={class:"chat-time"},k={key:0,class:"msg-read success"},L={class:"chat-info"},b={key:0,class:"chat-img"},w={class:"img-wrap"},x=["src"],C={class:"img-overlay"},E=["onClick"],M=["href","title"],T={key:1,class:"chat-img"},P={class:"img-wrap"},j=["src"],I={class:"img-overlay"},_=["onClick"],F={key:2,class:"message-video"},X={controls:""},R=["src"],A={key:3,class:"chat-img"},O={class:"img-wrap"},Q=["src"],S={class:"img-overlay"},D=["onClick"],U={key:4,class:"message-audio"},B={controls:""},z=["src"],W={key:5,class:"chat-img"},N={class:"img-wrap"},G=["src"],J={class:"img-overlay"},H=["onClick"],K={key:6,class:"file-attach"},V={class:"ms-2 overflow-hidden"},Y={class:"mb-1"},q=["href"],Z={key:7,class:"chat-img"},ee={class:"img-wrap"},te=["src"],ae={class:"img-overlay"},re=["href"],ne=["innerHTML"],ie={key:8,class:"message-link"},se=["href"],oe={class:"chat-actions"},le={class:"dropdown-menu dropdown-menu-end p-3"},ce=["onClick"],de={key:0},ue=["onClick"],fe={class:"chat-footer"},pe={class:"footer-form"},me={class:"chat-footer-wrap"},he={class:"form-wrap"},ve=["disabled"],ge={class:"form-item position-relative d-flex align-items-center justify-content-center"},ye=["accept"],ke={class:"form-item"},Le={class:"dropdown-menu dropdown-menu-end p-3"},be={class:"form-btn"},we=["disabled"],xe={class:"modal fade",id:"previewmodal",tabindex:"-1","aria-labelledby":"filePreviewModalLabel","aria-hidden":"true",ref:"fileModal"},Ce={class:"modal-dialog modal-dialog-centered modal-lg"},Ee={class:"modal-content"},Me={class:"modal-header"},Te={class:"modal-title"},Pe={class:"modal-body row"},je={key:0,class:"col-12 d-flex justify-content-center"},Ie=["src"],$e={key:1,class:"col-12 d-flex justify-content-center"},_e={controls:""},Fe=["src"],Xe={key:2,class:"col-12 d-flex justify-content-center"},Re={controls:""},Ae=["src"],Oe={key:3,class:"col-12 d-flex justify-content-center"},Qe=["src"],Se=["src"],De={class:"col-12 mt-4"},Ue=["disabled"],Be={class:"modal-footer"},ze=["disabled"],We={class:"modal fade",id:"cameraModal",tabindex:"-1","aria-labelledby":"filePreviewModalLabel","aria-hidden":"true",ref:"cameraModal"},Ne={class:"modal-dialog modal-dialog-centered modal-lg"},Ge={class:"modal-content"},Je={class:"modal-body row"},He={key:0,class:"col-12 d-flex justify-content-center"},Ke={ref:"videoCamera",autoplay:""},Ve={ref:"canvas",style:{display:"none"}},Ye={key:1,class:"col-12 d-flex justify-content-center"},qe=["src"],Ze={class:"col-12 mt-4"},et=["disabled"],tt={class:"modal-footer"},at=["disabled"];var rt,nt=a(964),it=a(781),st=a(762),ot=a(537),lt=a(57),ct=a(947),dt=a.n(ct);function ut(e){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ut(e)}function ft(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=ut(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ut(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function pt(e){return function(e){if(Array.isArray(e))return mt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return mt(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?mt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=Array(t);a<t;a++)r[a]=e[a];return r}function ht(){ht=function(){return t};var e,t={},a=Object.prototype,r=a.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,a){return e[t]=a}}function d(e,t,a,r){var i=t&&t.prototype instanceof g?t:g,s=Object.create(i.prototype),o=new I(r||[]);return n(s,"_invoke",{value:M(e,a,o)}),s}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var f="suspendedStart",p="suspendedYield",m="executing",h="completed",v={};function g(){}function y(){}function k(){}var L={};c(L,s,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b($([])));w&&w!==a&&r.call(w,s)&&(L=w);var x=k.prototype=g.prototype=Object.create(L);function C(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function a(n,i,s,o){var l=u(e[n],e,i);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==ut(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){a("next",e,s,o)}),(function(e){a("throw",e,s,o)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return a("throw",e,s,o)}))}o(l.arg)}var i;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){a(e,r,t,n)}))}return i=i?i.then(n,n):n()}})}function M(t,a,r){var n=f;return function(i,s){if(n===m)throw Error("Generator is already running");if(n===h){if("throw"===i)throw s;return{value:e,done:!0}}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var l=T(o,r);if(l){if(l===v)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=m;var c=u(t,a,r);if("normal"===c.type){if(n=r.done?h:p,c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=h,r.method="throw",r.arg=c.arg)}}}function T(t,a){var r=a.method,n=t.iterator[r];if(n===e)return a.delegate=null,"throw"===r&&t.iterator.return&&(a.method="return",a.arg=e,T(t,a),"throw"===a.method)||"return"!==r&&(a.method="throw",a.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=u(n,t.iterator,a.arg);if("throw"===i.type)return a.method="throw",a.arg=i.arg,a.delegate=null,v;var s=i.arg;return s?s.done?(a[t.resultName]=s.value,a.next=t.nextLoc,"return"!==a.method&&(a.method="next",a.arg=e),a.delegate=null,v):s:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,v)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function $(t){if(t||""===t){var a=t[s];if(a)return a.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function a(){for(;++n<t.length;)if(r.call(t,n))return a.value=t[n],a.done=!1,a;return a.value=e,a.done=!0,a};return i.next=i}}throw new TypeError(ut(t)+" is not iterable")}return y.prototype=k,n(x,"constructor",{value:k,configurable:!0}),n(k,"constructor",{value:y,configurable:!0}),y.displayName=c(k,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,c(e,l,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},C(E.prototype),c(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,a,r,n,i){void 0===i&&(i=Promise);var s=new E(d(e,a,r,n),i);return t.isGeneratorFunction(a)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},C(x),c(x,l,"Generator"),c(x,s,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),a=[];for(var r in t)a.push(r);return a.reverse(),function e(){for(;a.length;){var r=a.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=$,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var a in this)"t"===a.charAt(0)&&r.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var a=this;function n(r,n){return o.type="throw",o.arg=t,a.next=r,n&&(a.method="next",a.arg=e),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),j(a),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var r=a.completion;if("throw"===r.type){var n=r.arg;j(a)}return n}}throw Error("illegal catch attempt")},delegateYield:function(t,a,r){return this.delegate={iterator:$(t),resultName:a,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}function vt(e,t,a,r,n,i,s){try{var o=e[i](s),l=o.value}catch(e){return void a(e)}o.done?t(l):Promise.resolve(l).then(r,n)}function gt(e){return function(){var t=this,a=arguments;return new Promise((function(r,n){var i=e.apply(t,a);function s(e){vt(i,r,n,s,o,"next",e)}function o(e){vt(i,r,n,s,o,"throw",e)}s(void 0)}))}}const yt={components:{},data:function(){return{intervalId:null,chatId:null,autoread:!1,camera:{modal:!1,picture:null,stream:null},fileTypes:".pdf, .doc, .docx, .xlsx, .zip, .html, .php, .css, .js, .ppt, .txt",attribute:{image:nt.A,audio:it.A,video:st.A,document:ot.A,location:lt.A,modal:!1},message:{list:[],loader:!0,last_chat:"",search:""},send:{loader:!1,type:"text",text:"",file:null,location:{long:"",lang:""}},file:{file:null,filePreview:null,previewType:"",fileName:"",isPDF:!1}}},computed:{},methods:(rt={openModalCam:function(){var e=this;return gt(ht().mark((function t(){return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.camera.modal=!0,new bootstrap.Modal(e.$refs.cameraModal,{backdrop:"static",keyboard:!1}).show(),t.next=5,e.openCamera();case 5:case"end":return t.stop()}}),t)})))()},openCamera:function(){var e=this;return gt(ht().mark((function t(){return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.mediaDevices.getUserMedia({video:!0});case 3:e.camera.stream=t.sent,e.$refs.videoCamera.srcObject=e.camera.stream,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Kamera tidak dapat diakses",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},capturePhoto:function(){var e=this.$refs.canvas,t=this.$refs.videoCamera;(e.width=t.videoWidth,e.height=t.videoHeight,e.getContext("2d").drawImage(t,0,0,e.width,e.height),this.camera.picture=e.toDataURL("image/jpeg"),this.camera.stream)&&this.camera.stream.getTracks().forEach((function(e){return e.stop()}))},reTakePhoto:function(){var e=this;return gt(ht().mark((function t(){return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.camera={modal:!1,picture:null,stream:null},e.openCamera();case 2:case"end":return t.stop()}}),t)})))()},sendPhoto:function(){var e=this;return gt(ht().mark((function t(){return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.send.type="photo",e.send.file=e.camera.picture,e.camera.stream&&e.camera.stream.getTracks().forEach((function(e){return e.stop()})),t.next=5,e.sendMessage();case 5:e.camera={modal:!1,picture:null,stream:null},document.getElementById("closeModalCamera").click();case 8:case"end":return t.stop()}}),t)})))()},closeModal:function(){},confirmFile:function(){var e=this;return gt(ht().mark((function t(){return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.sendMessage();case 2:e.closeModal();case 3:case"end":return t.stop()}}),t)})))()},closeCamera:function(){this.camera.stream&&this.camera.stream.getTracks().forEach((function(e){return e.stop()}));this.camera={modal:!1,picture:null,stream:null}},triggerFileInput:function(){this.$refs.fileInput.click()},setFileType:function(e){var t=this;this.fileTypes=e,setTimeout((function(){t.triggerFileInput()}),1e3)},handleFileChange:function(e){var t=e.target.files[0];t&&(this.file.fileName=t.name,this.send.file=t,t.type.startsWith("image")?(this.file.previewType="image",this.file.filePreview=URL.createObjectURL(t),this.send.type="media"):t.type.startsWith("video")?(this.file.previewType="video",this.file.filePreview=URL.createObjectURL(t),this.send.type="media"):t.type.startsWith("audio")?(this.file.previewType="audio",this.file.filePreview=URL.createObjectURL(t),this.send.type="media"):"application/pdf"===t.type?(this.file.previewType="document",this.send.type="document",this.file.filePreview=URL.createObjectURL(t),this.file.isPDF=!0):(this.send.type="document",this.file.previewType="document",this.file.filePreview=null,this.file.isPDF=!1),new bootstrap.Modal(this.$refs.fileModal,{backdrop:"static",keyboard:!1}).show())}},ft(ft(ft(ft(ft(ft(ft(ft(ft(ft(rt,"closeModal",(function(){document.getElementById("closeModal").click()})),"confirmFile",(function(){var e=this;return gt(ht().mark((function t(){return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.sendMessage();case 2:e.closeModal();case 3:case"end":return t.stop()}}),t)})))()})),"resetFile",(function(){document.getElementById("files").value="",this.send.type="text",this.send.file=null,this.file.filePreview=null,this.file.fileName="",this.file.previewType="",this.file.isPDF=!1})),"getMessages",(function(){var e=arguments,t=this;return gt(ht().mark((function a(){var r,n,i,s,o,l;return ht().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:"",a.prev=1,a.next=4,t.$axios.get("/device/chats/detail/".concat(t.$route.params.id,"/").concat(t.$route.params.chatid,"?last_id=").concat(r));case 4:i=a.sent,s=i.data,o=(o=Array.isArray(s.list)?s.list:Object.values(s.list)).filter((function(e){return!t.message.list.some((function(t){return t.id===e.id}))})),t.chatId=s.chatid,t.message.loader=!1,t.autoread=s.autoread,t.message.last_chat=s.last_chat,(n=t.message.list).push.apply(n,pt(o)),o.length>0&&t.scrollToBottom(),s.autoread&&(l=o.filter((function(e){return"UNREAD"===e.status&&!e.sender})).map((function(e){return{remoteJid:e.for_read.remoteJid,id:e.id}}))).length>0&&t.markReadMessages(l),a.next=21;break;case 17:a.prev=17,a.t0=a.catch(1),t.$handleErrorResponse(a.t0),console.log(a.t0);case 21:case"end":return a.stop()}}),a,null,[[1,17]])})))()})),"markReadMessages",(function(e){var t=this;return gt(ht().mark((function a(){return ht().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$axios.post("/device/misc/read-messages/".concat(t.$route.params.id),{chatid:t.chatId,messages:e});case 3:a.sent,a.next=9;break;case 6:a.prev=6,a.t0=a.catch(0),console.log(a.t0);case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))()})),"deleteMessage",(function(e){var t=this;return gt(ht().mark((function a(){var r;return ht().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$axios.post("/device/misc/delete-message/".concat(t.$route.params.id),{chatid:t.chatId,message:{key:{remoteJid:t.chatId,fromMe:e.sender,id:e.id},deleteMedia:"text"!=e.type||"location"!=e.type,timestamp:e.timestamp}});case 3:-1!==(r=t.message.list.findIndex((function(t){return e.id==t.id})))&&t.message.list.splice(r,1),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(a.t0);case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()})),"deleteEveryOne",(function(e){var t=this;return gt(ht().mark((function a(){var r;return ht().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$axios.post("/device/misc/delete-everyone/".concat(t.$route.params.id),{chatid:t.chatId,message:{remoteJid:t.chatId,fromMe:e.sender,id:e.id}});case 3:-1!==(r=t.message.list.findIndex((function(t){return e.id==t.id})))&&t.message.list.splice(r,1),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(a.t0);case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()})),"formattedText",(function(e){return e.replace(/\n/g,"<br>")})),"scrollToBottom",(function(){var e=document.querySelector(".chat-area");e&&(e.scrollTop=e.scrollHeight)})),"startPolling",(function(){var e=this;this.intervalId&&clearInterval(this.intervalId),this.intervalId=setInterval((function(){"chat_room"==e.$route.name?e.message.loader||e.getMessages(e.message.last_chat):e.stopPolling()}),5e3)})),ft(ft(ft(ft(ft(ft(ft(ft(rt,"stopPolling",(function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)})),"downloadMedia",(function(e,t,a){var r=this;return gt(ht().mark((function n(){var i,s,o;return ht().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return dt().start(),dt().set(.1),n.prev=2,n.next=5,r.$axios.post("/device/misc/download-media/".concat(r.$route.params.id),{type:a,medianame:t,message:e});case 5:i=n.sent,dt().done(),s=i.data,r.$showToast("Berhasil mengunduh media","info",3e3),200==i.status&&-1!==(o=r.message.list.findIndex((function(e){return t==e.id})))&&(r.message.list[o].message.detail.url=s.data.downloadPath,r.message.list[o].message.detail.asset=!0),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(2),dt().done(),r.$showToast("Media gagal di unduh","info",3e3);case 16:case"end":return n.stop()}}),n,null,[[2,12]])})))()})),"autoResize",(function(){var e=this.$refs.messageInput;e.style.height="auto",e.style.height=e.scrollHeight+"px"})),"autoResizeModal",(function(){var e=this.$refs.messageInputModal;e.style.height="auto",e.style.height=e.scrollHeight+"px"})),"handleEnter",(function(e){e.shiftKey||(e.preventDefault(),this.sendMessage())})),"autoResizeCamera",(function(){var e=this.$refs.messageInputCamera;e.style.height="auto",e.style.height=e.scrollHeight+"px"})),"insertLineBreak",(function(){var e=this;this.send.text+="\n",this.$nextTick((function(){e.autoResize()}))})),"sendMessage",(function(){var e=this;return gt(ht().mark((function t(){var a;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return dt().start(),dt().set(.1),e.send.loader=!0,t.prev=3,(a=new FormData).append("type",e.send.type),a.append("phone",e.$route.params.chatid),a.append("text",e.send.text),e.send.file&&("photo"==e.send.type?a.append("photo",e.send.file):a.append("file",e.send.file)),t.next=11,e.$axios.post("device/chats/send/".concat(e.$route.params.id),a,{headers:{"Content-Type":"multipart/form-data"}});case 11:t.sent,dt().done(),e.send={loader:!1,type:"text",text:"",file:null,location:{long:"",lang:""}},e.resetFile(),e.$showToast("Berhasil mengirim pesan","info",3e3),t.next=23;break;case 18:t.prev=18,t.t0=t.catch(3),dt().done(),e.send.loader=!1,e.$handleErrorResponse(t.t0);case 23:case"end":return t.stop()}}),t,null,[[3,18]])})))()}))),beforeDestroy:function(){this.stopPolling()},updated:function(){this.scrollToBottom()},mounted:function(){var e=this;$(".chat-search-btn").on("click",(function(){$(".chat-search").toggleClass("visible-chat")})),$(".close-btn-chat").on("click",(function(){$(".chat-search").removeClass("visible-chat")})),$("#closeModal").on("click",(function(){e.resetFile()})),$("#closeModalCamera").on("click",(function(){e.closeCamera()}))},watch:{"$route.params.chatid":{handler:function(){var e=this;this.stopPolling(),"chat_room"==this.$route.name&&(this.message={list:[],loader:!0,last_chat:"",search:""},this.getMessages("").then((function(){e.startPolling()})))},immediate:!0}}};var kt=a(72),Lt=a.n(kt),bt=a(253),wt={insert:"head",singleton:!1};Lt()(bt.A,wt);bt.A.locals;const xt=(0,a(262).A)(yt,[["render",function(e,t,a,$,rt,nt){var it=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("div",n,[(0,r.Lk)("div",null,[(0,r.Lk)("div",i,[(0,r.Lk)("div",s,[t[22]||(t[22]=(0,r.Lk)("div",{class:"d-xl-none"},[(0,r.Lk)("a",{class:"text-muted chat-close me-2",href:"#"},[(0,r.Lk)("i",{class:"fas fa-arrow-left"})])],-1)),(0,r.Lk)("div",o,[(0,r.Lk)("img",{src:e.$route.query.photo,class:"rounded-circle",alt:"image"},null,8,l)]),(0,r.Lk)("div",c,[(0,r.Lk)("h6",null,(0,r.v_)(e.$route.query.name),1),t[21]||(t[21]=(0,r.Lk)("span",{class:"last-seen"},"-",-1))])]),(0,r.Lk)("div",d,[(0,r.Lk)("ul",null,[t[25]||(t[25]=(0,r.Lk)("li",null,[(0,r.Lk)("a",{href:"javascript:void(0)",class:"btn chat-search-btn","data-bs-toggle":"tooltip","data-bs-placement":"bottom",title:"Search"},[(0,r.Lk)("i",{class:"ti ti-search"})])],-1)),(0,r.Lk)("li",null,[t[24]||(t[24]=(0,r.Lk)("a",{class:"btn no-bg",href:"#","data-bs-toggle":"dropdown"},[(0,r.Lk)("i",{class:"ti ti-dots-vertical"})],-1)),(0,r.Lk)("ul",u,[(0,r.Lk)("li",null,[(0,r.bF)(it,{to:{name:"blank_chat",params:{id:e.$route.params.id}},class:"dropdown-item"},{default:(0,r.k6)((function(){return t[23]||(t[23]=[(0,r.Lk)("i",{class:"ti ti-x me-2"},null,-1),(0,r.eW)("Close Message")])})),_:1},8,["to"])])])])])]),(0,r.Lk)("div",f,[(0,r.Lk)("div",p,[(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=function(e){return rt.message.search=e}),placeholder:"Search Message"},null,512),[[r.Jo,rt.message.search]]),t[26]||(t[26]=(0,r.Lk)("span",{class:"input-group-text"},[(0,r.Lk)("i",{class:"ti ti-search"})],-1))])])]),(0,r.Lk)("div",m,[rt.message.loader?((0,r.uX)(),(0,r.CE)("div",h,t[27]||(t[27]=[(0,r.Lk)("div",{class:"lds-roller"},[(0,r.Lk)("div"),(0,r.Lk)("div"),(0,r.Lk)("div"),(0,r.Lk)("div"),(0,r.Lk)("div"),(0,r.Lk)("div"),(0,r.Lk)("div"),(0,r.Lk)("div")],-1)]))):(0,r.Q3)("",!0),(0,r.Lk)("div",v,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(rt.message.list.filter((function(e){return e.message.detail.text.toLowerCase().includes(rt.message.search.toLowerCase())})),(function(e,a){return(0,r.uX)(),(0,r.CE)("div",{class:(0,r.C4)(["chats",e.sender?"chats-right":""]),key:a},[(0,r.Lk)("div",g,[(0,r.Lk)("div",{class:(0,r.C4)(["chat-profile-name d-flex justify-content-end",e.sender?"me-4":"ms-4"])},[(0,r.Lk)("h6",null,[(0,r.Lk)("span",y,(0,r.v_)(e.time),1),"READ"==e.status?((0,r.uX)(),(0,r.CE)("span",k,t[28]||(t[28]=[(0,r.Lk)("i",{class:"ti ti-checks"},null,-1)]))):(0,r.Q3)("",!0)])],2),(0,r.Lk)("div",L,[(0,r.Lk)("div",{class:(0,r.C4)(["message-content","audio"!=e.message.type||e.sender?"":"bg-transparent p-0"])},["image"==e.message.type?((0,r.uX)(),(0,r.CE)("div",b,[(0,r.Lk)("div",w,[(0,r.Lk)("img",{src:e.message.detail.asset?e.message.detail.url:rt.attribute.image,alt:"img",style:(0,r.Tr)(e.message.detail.asset?"":"height: 100%")},null,12,x),(0,r.Lk)("div",C,[e.message.detail.asset?((0,r.uX)(),(0,r.CE)("a",{key:1,class:"gallery-img","data-fancybox":"gallery-img",href:e.message.detail.url,title:e.message.detail.text},t[30]||(t[30]=[(0,r.Lk)("i",{class:"ti ti-eye"},null,-1)]),8,M)):((0,r.uX)(),(0,r.CE)("a",{key:0,class:"ti ti-download fs-30",href:"javascript:void(0);",onClick:function(t){return nt.downloadMedia(e.details,e.id,e.message.mime)}},t[29]||(t[29]=[(0,r.Lk)("i",null,null,-1)]),8,E))])])])):(0,r.Q3)("",!0),"video"!=e.message.type||e.message.detail.asset?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",T,[(0,r.Lk)("div",P,[(0,r.Lk)("img",{src:rt.attribute.video,alt:"img",style:(0,r.Tr)(e.message.detail.asset?"":"height: 100%")},null,12,j),(0,r.Lk)("div",I,[e.message.detail.asset?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("a",{key:0,class:"ti ti-download fs-30",href:"javascript:void(0);",onClick:function(t){return nt.downloadMedia(e.details,e.id,e.message.mime)}},t[31]||(t[31]=[(0,r.Lk)("i",null,null,-1)]),8,_))])])])),"video"==e.message.type&&e.message.detail.asset?((0,r.uX)(),(0,r.CE)("div",F,[(0,r.Lk)("video",X,[(0,r.Lk)("source",{src:e.message.detail.url,type:"video/mp4"},null,8,R)])])):(0,r.Q3)("",!0),"audio"!=e.message.type||e.message.detail.asset?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",A,[(0,r.Lk)("div",O,[(0,r.Lk)("img",{src:rt.attribute.audio,alt:"img",style:(0,r.Tr)(e.message.detail.asset?"":"height: 100%")},null,12,Q),(0,r.Lk)("div",S,[e.message.detail.asset?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("a",{key:0,class:"ti ti-download fs-30",href:"javascript:void(0);",onClick:function(t){return nt.downloadMedia(e.details,e.id,e.message.mime)}},t[32]||(t[32]=[(0,r.Lk)("i",null,null,-1)]),8,D))])])])),"audio"==e.message.type&&e.message.detail.asset?((0,r.uX)(),(0,r.CE)("div",U,[(0,r.Lk)("audio",B,[(0,r.Lk)("source",{src:e.message.detail.url,type:"audio/mpeg"},null,8,z)])])):(0,r.Q3)("",!0),"document"!=e.message.type||e.message.detail.asset?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",W,[(0,r.Lk)("div",N,[(0,r.Lk)("img",{src:rt.attribute.document,alt:"img",style:(0,r.Tr)(e.message.detail.asset?"":"height: 100%")},null,12,G),(0,r.Lk)("div",J,[e.message.detail.asset?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("a",{key:0,class:"ti ti-download fs-30",href:"javascript:void(0);",onClick:function(t){return nt.downloadMedia(e.details,e.id,e.message.mime)}},t[33]||(t[33]=[(0,r.Lk)("i",null,null,-1)]),8,H))])])])),"document"==e.message.type&&e.message.detail.asset?((0,r.uX)(),(0,r.CE)("div",K,[t[35]||(t[35]=(0,r.Lk)("span",{class:"file-icon"},[(0,r.Lk)("i",{class:"ti ti-files"})],-1)),(0,r.Lk)("div",V,[(0,r.Lk)("h6",Y,(0,r.v_)(e.message.detail.title),1),(0,r.Lk)("p",null," File "+(0,r.v_)(e.message.mime),1)]),(0,r.Lk)("a",{target:"_blank",href:e.message.detail.url,class:"download-icon"},t[34]||(t[34]=[(0,r.Lk)("i",{class:"ti ti-download"},null,-1)]),8,q)])):(0,r.Q3)("",!0),"location"==e.message.type?((0,r.uX)(),(0,r.CE)("div",Z,[(0,r.Lk)("div",ee,[(0,r.Lk)("img",{src:rt.attribute.location,alt:"img",style:{height:"100%"}},null,8,te),(0,r.Lk)("div",ae,[(0,r.Lk)("a",{class:"ti ti-url fs-30",target:"_blank",href:e.message.detail.url},t[36]||(t[36]=[(0,r.Lk)("i",null,null,-1)]),8,re)])])])):(0,r.Q3)("",!0),(0,r.Lk)("div",{innerHTML:nt.formattedText(e.message.detail.text)},null,8,ne),null!=e.message.url?((0,r.uX)(),(0,r.CE)("div",ie,[(0,r.Lk)("a",{href:e.message.url,target:"_blank",class:"link-primary mt-2"},(0,r.v_)(e.message.url),9,se)])):(0,r.Q3)("",!0)],2),(0,r.Lk)("div",oe,[t[39]||(t[39]=(0,r.Lk)("a",{class:"#",href:"#","data-bs-toggle":"dropdown"},[(0,r.Lk)("i",{class:"ti ti-dots-vertical"})],-1)),(0,r.Lk)("ul",le,[(0,r.Lk)("li",null,[(0,r.Lk)("a",{class:"dropdown-item",href:"javascript:void(0);",onClick:function(t){return nt.deleteMessage(e)}},t[37]||(t[37]=[(0,r.Lk)("i",{class:"ti ti-trash me-2"},null,-1),(0,r.eW)("Delete Message")]),8,ce)]),e.sender?((0,r.uX)(),(0,r.CE)("li",de,[(0,r.Lk)("a",{class:"dropdown-item",href:"javascript:void(0);",onClick:function(t){return nt.deleteEveryOne(e)}},t[38]||(t[38]=[(0,r.Lk)("i",{class:"ti ti-trash me-2"},null,-1),(0,r.eW)("Pull Message")]),8,ue)])):(0,r.Q3)("",!0)])])])])],2)})),128))])])]),(0,r.Lk)("div",fe,[(0,r.Lk)("form",pe,[(0,r.Lk)("div",me,[(0,r.Lk)("div",he,[(0,r.bo)((0,r.Lk)("textarea",{class:"form-control",placeholder:"Type Your Message",ref:"messageInput",rows:"1",disabled:rt.send.loader,onInput:t[1]||(t[1]=function(){return nt.autoResize&&nt.autoResize.apply(nt,arguments)}),onKeydown:[t[2]||(t[2]=(0,r.jR)((function(){return nt.handleEnter&&nt.handleEnter.apply(nt,arguments)}),["enter"])),t[3]||(t[3]=(0,r.jR)((0,r.D$)((function(){return nt.insertLineBreak&&nt.insertLineBreak.apply(nt,arguments)}),["shift","prevent"]),["enter"]))],"onUpdate:modelValue":t[4]||(t[4]=function(e){return rt.send.text=e})},null,40,ve),[[r.Jo,rt.send.text]])]),(0,r.Lk)("div",ge,[(0,r.Lk)("a",{href:"#",onClick:t[5]||(t[5]=function(e){return nt.setFileType(".pdf, .doc, .docx, .xlsx, .zip, .html, .php, .css, .js, .ppt, .txt")}),class:"action-circle position-absolute"},t[40]||(t[40]=[(0,r.Lk)("i",{class:"ti ti-file"},null,-1)])),(0,r.Lk)("input",{type:"file",class:"open-file position-relative",name:"files",ref:"fileInput",id:"files",accept:rt.fileTypes,onChange:t[6]||(t[6]=function(){return nt.handleFileChange&&nt.handleFileChange.apply(nt,arguments)})},null,40,ye)]),(0,r.Lk)("div",ke,[t[44]||(t[44]=(0,r.Lk)("a",{href:"#","data-bs-toggle":"dropdown"},[(0,r.Lk)("i",{class:"ti ti-dots-vertical"})],-1)),(0,r.Lk)("div",Le,[(0,r.Lk)("a",{href:"javascript:void(0);",onClick:t[7]||(t[7]=function(){return nt.openModalCam&&nt.openModalCam.apply(nt,arguments)}),class:"dropdown-item"},t[41]||(t[41]=[(0,r.Lk)("i",{class:"ti ti-camera-selfie me-2"},null,-1),(0,r.eW)("Camera")])),(0,r.Lk)("a",{href:"#",class:"dropdown-item",onClick:t[8]||(t[8]=function(e){return nt.setFileType("image/*")})},t[42]||(t[42]=[(0,r.Lk)("i",{class:"ti ti-photo-up me-2"},null,-1),(0,r.eW)(" Gallery ")])),(0,r.Lk)("a",{href:"#",class:"dropdown-item",onClick:t[9]||(t[9]=function(e){return nt.setFileType("video/*")})},t[43]||(t[43]=[(0,r.Lk)("i",{class:"ti ti-video me-2"},null,-1),(0,r.eW)(" Video ")]))])]),(0,r.Lk)("div",be,[(0,r.Lk)("button",{class:"btn btn-primary",type:"button",disabled:rt.send.loader,onClick:t[10]||(t[10]=function(){return nt.sendMessage&&nt.sendMessage.apply(nt,arguments)})},[(0,r.Lk)("i",{class:(0,r.C4)(rt.send.loader?"ti ti-circle":"ti ti-send")},null,2)],8,we)])])])])]),(0,r.Lk)("div",xe,[(0,r.Lk)("div",Ce,[(0,r.Lk)("div",Ee,[(0,r.Lk)("div",Me,[(0,r.Lk)("h4",Te," Send "+(0,r.v_)("document"==rt.file.previewType?"Dokument":"Media"),1),t[45]||(t[45]=(0,r.Lk)("button",{type:"button",class:"btn-close",id:"closeModal","data-bs-dismiss":"modal"},[(0,r.Lk)("i",{class:"ti ti-x"})],-1))]),(0,r.Lk)("div",Pe,["image"===rt.file.previewType?((0,r.uX)(),(0,r.CE)("div",je,[(0,r.Lk)("img",{src:rt.file.filePreview,alt:"Image Preview",class:"img-fluid"},null,8,Ie)])):(0,r.Q3)("",!0),"video"===rt.file.previewType?((0,r.uX)(),(0,r.CE)("div",$e,[(0,r.Lk)("video",_e,[(0,r.Lk)("source",{src:rt.file.filePreview,type:"video/mp4"},null,8,Fe)])])):(0,r.Q3)("",!0),"audio"===rt.file.previewType?((0,r.uX)(),(0,r.CE)("div",Xe,[(0,r.Lk)("audio",Re,[(0,r.Lk)("source",{src:rt.file.filePreview,type:"audio/mpeg"},null,8,Ae)])])):(0,r.Q3)("",!0),"document"===rt.file.previewType?((0,r.uX)(),(0,r.CE)("div",Oe,[rt.file.isPDF?((0,r.uX)(),(0,r.CE)("embed",{key:0,src:rt.file.filePreview,type:"application/pdf",width:"100%",height:"400px"},null,8,Qe)):((0,r.uX)(),(0,r.CE)("img",{key:1,src:rt.attribute.document,class:"w-50",alt:"img"},null,8,Se))])):(0,r.Q3)("",!0),(0,r.Lk)("div",De,[(0,r.bo)((0,r.Lk)("textarea",{class:"form-control",placeholder:"Type Your Message",ref:"messageInputModal",rows:"1",disabled:rt.send.loader,onInput:t[11]||(t[11]=function(){return nt.autoResizeModal&&nt.autoResizeModal.apply(nt,arguments)}),onKeydown:t[12]||(t[12]=(0,r.jR)((0,r.D$)((function(){return nt.insertLineBreak&&nt.insertLineBreak.apply(nt,arguments)}),["shift","prevent"]),["enter"])),"onUpdate:modelValue":t[13]||(t[13]=function(e){return rt.send.text=e})},null,40,Ue),[[r.Jo,rt.send.text]])])]),(0,r.Lk)("div",Be,[(0,r.Lk)("button",{type:"button",disabled:rt.send.loader,class:"btn btn-primary",onClick:t[14]||(t[14]=function(){return nt.confirmFile&&nt.confirmFile.apply(nt,arguments)})},[(0,r.eW)((0,r.v_)(rt.send.loader?"Loading...":"Send Message")+" ",1),t[46]||(t[46]=(0,r.Lk)("i",{class:"ti ti-send ms-2"},null,-1))],8,ze)])])])],512),(0,r.Lk)("div",We,[(0,r.Lk)("div",Ne,[(0,r.Lk)("div",Ge,[t[50]||(t[50]=(0,r.Lk)("div",{class:"modal-header"},[(0,r.Lk)("h4",{class:"modal-title"},"Take Photo"),(0,r.Lk)("button",{type:"button",class:"btn-close",id:"closeModalCamera","data-bs-dismiss":"modal"},[(0,r.Lk)("i",{class:"ti ti-x"})])],-1)),(0,r.Lk)("div",Je,[null==rt.camera.picture?((0,r.uX)(),(0,r.CE)("div",He,[(0,r.Lk)("video",Ke,null,512),(0,r.Lk)("canvas",Ve,null,512)])):(0,r.Q3)("",!0),null!=rt.camera.picture?((0,r.uX)(),(0,r.CE)("div",Ye,[(0,r.Lk)("img",{src:rt.camera.picture,alt:"Image Preview",class:"img-fluid"},null,8,qe)])):(0,r.Q3)("",!0),(0,r.Lk)("div",Ze,[(0,r.bo)((0,r.Lk)("textarea",{class:"form-control",placeholder:"Type Your Message",ref:"messageInputCamera",rows:"1",disabled:rt.send.loader,onInput:t[15]||(t[15]=function(){return nt.autoResizeCamera&&nt.autoResizeCamera.apply(nt,arguments)}),onKeydown:t[16]||(t[16]=(0,r.jR)((0,r.D$)((function(){return nt.insertLineBreak&&nt.insertLineBreak.apply(nt,arguments)}),["shift","prevent"]),["enter"])),"onUpdate:modelValue":t[17]||(t[17]=function(e){return rt.send.text=e})},null,40,et),[[r.Jo,rt.send.text]])])]),(0,r.Lk)("div",tt,[null==rt.camera.picture?((0,r.uX)(),(0,r.CE)("button",{key:0,type:"button",class:"btn btn-primary",onClick:t[18]||(t[18]=function(){return nt.capturePhoto&&nt.capturePhoto.apply(nt,arguments)})},t[47]||(t[47]=[(0,r.eW)(" Take Foto "),(0,r.Lk)("i",{class:"ti ti-camera ms-2"},null,-1)]))):(0,r.Q3)("",!0),null==rt.camera.picture||rt.send.loader?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("button",{key:1,type:"button",class:"btn btn-primary me-2",onClick:t[19]||(t[19]=function(){return nt.reTakePhoto&&nt.reTakePhoto.apply(nt,arguments)})},t[48]||(t[48]=[(0,r.eW)(" Re-Take "),(0,r.Lk)("i",{class:"ti ti-camera ms-2"},null,-1)]))),null!=rt.camera.picture?((0,r.uX)(),(0,r.CE)("button",{key:2,type:"button",disabled:rt.send.loader,onClick:t[20]||(t[20]=function(){return nt.sendPhoto&&nt.sendPhoto.apply(nt,arguments)}),class:"btn btn-primary"},[(0,r.eW)((0,r.v_)(rt.send.loader?"Loading...":"Send Photo")+" ",1),t[49]||(t[49]=(0,r.Lk)("i",{class:"ti ti-send ms-2"},null,-1))],8,at)):(0,r.Q3)("",!0)])])])],512)],64)}]])}}]);